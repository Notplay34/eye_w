# План до релиза

Что уже есть, что осталось сделать перед объявлением релиза и что отложено на следующие версии.

---

## Текущее состояние (MVP уже в проде)

| Блок | Статус | Комментарий |
|------|--------|-------------|
| Павильон 1 — форма документов | ✅ | Заказ, расчёт сумм, приём оплаты, печать docx |
| Павильон 2 — изготовление номеров | ✅ | Таблица заказов с номерами, смена статусов, доплата |
| Учёт платежей | ✅ | payments, типы (госпошлина, павильон 1/2) |
| Аналитика | ✅ | День, месяц, по сотрудникам — в админке |
| Сотрудники и роли | ✅ | CRUD, JWT, меню по ролям |
| Деплой и документация | ✅ | INSTALL.md, USER_GUIDE.md, setup_server.sh, сайт работает |

---

## До релиза 1.0 (объявить готовым)

Небольшие шаги, чтобы считать релиз «официальным».

| № | Задача | Приоритет | Оценка |
|---|--------|-----------|--------|
| 1 | **Чеклист перед продакшеном** | Высокий | — |
| 1.1 | Смена пароля суперпользователя после первого входа (или инструкция в INSTALL: «смените пароль в Управление аккаунтами») | Высокий | 0 (документация) |
| 1.2 | В INSTALL явно: отключить default nginx (`rm -f /etc/nginx/sites-enabled/default`) после первого деплоя | Средний | 5 мин |
| 1.3 | Проверка: резервное копирование БД (кратко в INSTALL или DEPLOYMENT — pg_dump) | Средний | 10 мин |
| 2 | **Версионирование** | Низкий | — |
| 2.1 | Версия в API (уже есть в FastAPI title) или в README — зафиксировать 1.0 | Низкий | 5 мин |

Итого: документация + пара пунктов в INSTALL; без обязательных доработок кода для «релиза 1.0».

---

## После релиза 1.0 (v1.1 и далее)

По PROJECT_CONTEXT осталось (отложено ранее):

| № | Фича | Описание | Приоритет |
|---|------|----------|-----------|
| 1 | **Склад заготовок номеров** | Учёт остатков, резервирование под заказ, списание при изготовлении | По запросу |
| 2 | **Кассы и смены** | Открытие/закрытие смены по павильонам, привязка платежей к смене, страница «Касса и смены» | ✅ Реализовано |
| 3 | **Доп. улучшения** | Экспорт аналитики (CSV/Excel), фильтры по датам в отчётах, смена пароля из профиля | По запросу |

Эти пункты не блокируют объявление релиза 1.0.

---

## Рекомендуемый порядок действий

1. **Сейчас:** выполнить пункты 1.1–1.3 из «До релиза 1.0» (инструкции + при необходимости одна правка в INSTALL).
2. **Объявить релиз 1.0:** текущая ветка `main` = 1.0, тег в git при желании.
3. **Дальше:** склад и кассы — по мере необходимости, как v1.1.

---

## Краткий чеклист «Готовность к 1.0»

- [x] На сервере: смена пароля sergey151 после первого входа (инструкция в INSTALL).
- [x] В INSTALL: пункт про отключение default nginx и про бэкап БД.
- [x] Сайт открывается по IP/домену, вход, меню, форма, павильон 2, админка работают.
- [x] Релиз 1.0 зафиксирован (версия в API 1.0.0, тег v1.0 в git).

План «до релиза» выполнен. Дальнейшее — по RELEASE_PLAN (v1.1).

---

## План дальше (по шагам)

### Сейчас (обязательно)

| Шаг | Что сделать |
|-----|-------------|
| 1 | **Убедиться, что БД с UTF-8.** Если была ошибка SQL_ASCII — пересоздать базу (см. INSTALL.md, раздел «Пересоздание БД с UTF-8»). |
| 2 | **Проверить сайт:** вход sergey151 / 1wq21wq2, форма заказа, «Принять наличные», павильон 2, админка. |
| 3 | **Сменить пароль** суперпользователя: Меню → Управление аккаунтами → изменить пароль для Сергея. |
| 4 | **Настроить бэкап** (по желанию): раз в день или неделю выполнять `pg_dump` (команда в INSTALL.md). |

### Дальше (по желанию)

| Этап | Что делать |
|------|------------|
| **Код в репозитории** | Закоммитить и запушить последние правки (UTF-8 в INSTALL, миграция public_id, обработка ошибок 500, pay с employee_id). Так на сервере после `git pull` будет актуальная версия. |
| **v1.1 — Склад** | Учёт заготовок номеров: остатки, резерв под заказ, списание при изготовлении (по PROJECT_CONTEXT). |
| **v1.1 — Кассы и смены** | ✅ Реализовано: смены по павильонам, привязка платежей, страница «Касса и смены» в меню. |
| **Улучшения** | Экспорт аналитики (CSV), фильтры по датам в отчётах, смена пароля из своего профиля. |

### Если что-то ломается

- Лог бэкенда: `journalctl -u eye_w --no-pager -n 50`
- Рестарт: `systemctl restart eye_w`
- Обновление с GitHub: `cd /opt/eye_w && git pull && systemctl restart eye_w`
